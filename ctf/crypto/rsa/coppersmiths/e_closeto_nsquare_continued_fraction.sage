#Different_RSA, gdqwb-2021, https://zhuanlan.zhihu.com/p/421202600

from tqdm import tqdm

N=28878766272191403823107889041058284169199808521158371682733066050244662799263367156309550269227101325669736027371771826809397253158613924644548712934884421417378014208087639969044807981377186737714340829286082351379351558923920227008127429160092666852532458086422142081205116705084311913772665687970343016885031103707028461199015059765479532800549778386359788105205971343282912784946850071662422979298574392484710573074515486971587923766953069962751794200877653014694387953177200024644885244403712103579400266188539111892932620741206480403759438884693193946568495787340335563344856666827548302085113710892285188352347515140126494219804766912500865837631112541745039505278461897206316347941630953618889264594051661709309130123886362948041284745802718880863003173754215754620092571809982610688745771085197335609922355484722672895954924759
e=16186320313634328496440713971074785841304525822423265323895397745902985674134930714985512130122130585358495182805165357607673807747191421361857418556427743463153062161878486396627708612985815610019432888231367459519707958734219934649008166152457125419582152501079960391640666982779851083909025636544459112681035010301904057266921231061461706495034756286588227231472275644370104625247555792513089183052836006811490713830170264738640391556567190040194986394243251111129639382576192872436593870106714478542927646829399154411798122696959308473416033325394147873354963391641332201357602973563982241770353321367375117564944582182668088458150973291125898858000161029093867671379835335431663438411211518217644240037557402724728819223358656389677968816187183622330242014133466051319331183187699937157561873540426466963139995885150754840959444740853406770096593657433572247166208475886191667626556346254016822836533740122874500535859657823826858769734486420676601874194269854191341737316733036088100115574309481733598510760055522706119532982074682014366708059877307785784618434457513085613770609723953390305489873834645800240852642084703877363023756755630577690010548262421800232594212409139433843558521829395398269230062378458858354148572202563611772747559609810292686624272558155840341343546422202325775405122621450008066802738473026641188027077236874176571833173561283784269477687952636795159844090200718657253926832941252787544439492831662954327590410011041187391111027219711010384431000890781109211071628204928122592404587280880333125714409296736396177044420938374575802139081816028614175323305679309766890752680721667469596239355337019967937363402467500660578061626391149283049479289

N, e = map(ZZ, (N, e))

def solve_pell (N, e , numTry = 35):
    X = e/(N^2+1-9/4*N)
    cf = continued_fraction (X)
    PR.<xx> = PolynomialRing(Zmod(N))
    p_low = floor(N^(1/4) / (2 ^ 80)) #need to loop to find suitable 80
    for i in tqdm(range ( numTry )):
        denom = cf . denominator ( i )
        numer = cf . numerator ( i )
        y, x = numer, denom
        if (y != 0):
            p_bar = 1/2 * ((abs((N+1)^2 - e*x/y))^(1/2) + (abs((N-1)^2 - e*x/y))^(1/2))
            p_bar = floor(p_bar)
            f = xx + p_bar

            sol = f.small_roots(X=p_low, beta=0.48, epsilon=0.03)
            if (len(sol) != 0):
                print('AOLIGEI!')
                p = ZZ(f(sol[0]))
                print(p)

print(N.nbits())
print(e.nbits())
solve_pell(N, e)