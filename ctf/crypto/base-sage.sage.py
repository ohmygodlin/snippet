

# This file was *autogenerated* from the file base-sage.sage
from sage.all_cmdline import *   # import sage library

_sage_const_40 = Integer(40); _sage_const_3 = Integer(3); _sage_const_14011 = Integer(14011); _sage_const_7 = Integer(7); _sage_const_6 = Integer(6); _sage_const_5 = Integer(5); _sage_const_4 = Integer(4); _sage_const_65537 = Integer(65537); _sage_const_31377 = Integer(31377); _sage_const_8 = Integer(8); _sage_const_114 = Integer(114); _sage_const_12 = Integer(12); _sage_const_0 = Integer(0); _sage_const_313 = Integer(313); _sage_const_14 = Integer(14); _sage_const_109770827223661560471527567179288748906402603483328748683689436879660543465776899146036833470531024202351087008847594392666852763100570391337823820240726499421306887565697452868723849092658743267256316770223643723095601213088336064635680075206929620159782416078143076506249031972043819429093074684182845530529249907297736582589125917235222921623698038868900282049587768700860009877737045693722732170123306528145661683416808514556360429554775212088169626620488741903267154641722293484797745665402402381445609873333905772582972140944493849645600529147490903067975300304532955461710562911203871840101407995813072692212 = Integer(109770827223661560471527567179288748906402603483328748683689436879660543465776899146036833470531024202351087008847594392666852763100570391337823820240726499421306887565697452868723849092658743267256316770223643723095601213088336064635680075206929620159782416078143076506249031972043819429093074684182845530529249907297736582589125917235222921623698038868900282049587768700860009877737045693722732170123306528145661683416808514556360429554775212088169626620488741903267154641722293484797745665402402381445609873333905772582972140944493849645600529147490903067975300304532955461710562911203871840101407995813072692212); _sage_const_19 = Integer(19); _sage_const_44538727182858207226040251762322467288176239968967952269350336889655421753182750730773886813281253762528207970314694060562016861614492626112150259048393048617529867598499261392152098087985858905944606287003243 = Integer(44538727182858207226040251762322467288176239968967952269350336889655421753182750730773886813281253762528207970314694060562016861614492626112150259048393048617529867598499261392152098087985858905944606287003243); _sage_const_2 = Integer(2); _sage_const_83408372012221120677052349409462320990177094246143674474872152829440524098582262384066400107950985845255268335597502228206679771838750219696329523257176739436871327238322817403970284015587320158034304282786944710043150568360761457471641695390427267786485448748458445872307883254297662715749746270343116946519 = Integer(83408372012221120677052349409462320990177094246143674474872152829440524098582262384066400107950985845255268335597502228206679771838750219696329523257176739436871327238322817403970284015587320158034304282786944710043150568360761457471641695390427267786485448748458445872307883254297662715749746270343116946519)
n = _sage_const_83408372012221120677052349409462320990177094246143674474872152829440524098582262384066400107950985845255268335597502228206679771838750219696329523257176739436871327238322817403970284015587320158034304282786944710043150568360761457471641695390427267786485448748458445872307883254297662715749746270343116946519 
c = _sage_const_109770827223661560471527567179288748906402603483328748683689436879660543465776899146036833470531024202351087008847594392666852763100570391337823820240726499421306887565697452868723849092658743267256316770223643723095601213088336064635680075206929620159782416078143076506249031972043819429093074684182845530529249907297736582589125917235222921623698038868900282049587768700860009877737045693722732170123306528145661683416808514556360429554775212088169626620488741903267154641722293484797745665402402381445609873333905772582972140944493849645600529147490903067975300304532955461710562911203871840101407995813072692212 

e = _sage_const_65537 
m = discrete_log_rho(c%n, e, n)
print hex(m)
exit()


# solve equation, PolyRSA, CryptoCTF 2022, https://zhuanlan.zhihu.com/p/543950067
n = _sage_const_44538727182858207226040251762322467288176239968967952269350336889655421753182750730773886813281253762528207970314694060562016861614492626112150259048393048617529867598499261392152098087985858905944606287003243 

PR = PolynomialRing(ZZ, names=('k',)); (k,) = PR._first_ngens(1)

p = k**_sage_const_6  + _sage_const_7 *k**_sage_const_4  - _sage_const_40 *k**_sage_const_3  + _sage_const_12 *k**_sage_const_2  - _sage_const_114 *k + _sage_const_31377 
q = k**_sage_const_5  - _sage_const_8 *k**_sage_const_4  + _sage_const_19 *k**_sage_const_3  - _sage_const_313 *k**_sage_const_2  - _sage_const_14 *k + _sage_const_14011 
n0 = p * q

f = n - n0
sol = f.roots()
x = sol[_sage_const_0 ][_sage_const_0 ]
p = p(x)
q = q(x)

